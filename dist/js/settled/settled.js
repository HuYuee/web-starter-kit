define(["jquery","util","template","webuploader","PCASClass"],function(e,a,t,i,n){e("body").css("visibility","visible"),e(function(){function a(){e(".upi1").hide(),e(".up1").mouseenter(function(){e(".upi1").fadeIn(),s(".upi1",".up1")}),e(".upi1").mouseleave(function(){e(".upi1").fadeOut()})}function t(a,t){if(""==e(".isv_name").val())return void e(".isv_name").addClass("errorinput");if(""==e(".settleds_Number").val())return void e(".settleds_Number").addClass("errorinput");if(""==e(".up1 img").attr("src")||void 0==e(".up1 img").attr("src"))return void e(".up1").addClass("errorinput");if(""==e(".bank_branchname").val())return void e(".bank_branchname").addClass("errorinput");if(""==e(".bank_username").val())return void e(".bank_username").addClass("errorinput");if(""==e(".bank_name").val())return void e(".bank_name").addClass("errorinput");if(""==e(".settled2_sw").val())return void e(".settled2_sw").addClass("errorinput");var i=e(".tenantArea1").val()+"/"+e(".tenantArea2").val(),n={isvName:e(".isv_name").val(),isvLogo:e(".settled_img2").find("img").attr("src")||"",isvMarket:e(".sttled2_category").val(),legalPerson:e(".tenantName").val(),industry:e(".sttled2_hangye option:selected").text(),location:i,officialSite:e(".companySite").val(),officialEmail:e(".settled_email").val(),linkmanName:e(".tenant_contactname").val(),linkmanMobile:e(".settled_phone").val(),linkmanEmail:e(".tenant_email").val(),chanpayAccount:e(".chanpayAccount").val(),licenceNumber:e(".settleds_Number").val(),orgNumber:e(".settleds_ZzNumber").val(),licencePic:e(".up1").find("img").attr("src")||"",officialSeal:e(".up2").find("img").attr("src")||"",authLetter:e(".up3").find("img").attr("src")||"",legalPersonIDPic:e(".up4").find("img").attr("src")||"",invoiceType:e(".settled2_fapiao").val(),invoiceTitle:e(".tenant_Fullname").val(),registerNum:e(".settled2_sw").val(),registerName:e(".bank_username").val(),registerAccount:e(".bank_name").val(),registerAccountBank:e(".bank_branchname").val(),registerPhone:e(".register_phone").val(),registerAddress:e(".register_address").val(),receiverMobile:e(".send_phone").val(),receiverName:e(".send_Name").val(),receiverAddress:e(".send_address").val()};e.ajax({type:"post",url:a,data:JSON.stringify(n),contentType:"application/json",dataType:"json",success:function(a){1==a.status?(e(".app_bottom_shenhew").css("visibility","visible").find("span").html(t),window.location.href="/market"):e(".app_bottom_shenhew").css("visibility","visible").find("span").html("申请失败，请重新申请")}})}function s(t,n){var s=i.create({server:"/market/file/upload/img",swf:"/market/market/src/vendor/uploader/swf/Uploader.swf?v="+Math.random(),pick:t,accept:[{title:"Images",extensions:"jpg,jpeg,png",mimeTypes:"image/jpg,image/jpeg,image/png"}],auto:!0,compress:!1});s.on("uploadSuccess",function(t,i){if("-1"!=i.fileName){var s=i.fileName,r="<img src="+s+" />";e(n).html(r),a(),e(".upi1").addClass("upi1_hover")}}),s.on("uploadError",function(e){}),s.on("fileQueued",function(e){if(e.size>5242880)return alert("文件大小不能超过5m"),!1})}var r=/^([a-z0-9A-Z]+[-|\.]?)+[a-z0-9A-Z]@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\.)+[a-zA-Z]{2,}$/,l=/^(13[0-9]|15[012356789]|17[0678]|18[0-9]|14[57])[0-9]{8}$/,o=navigator.userAgent,o=(o.indexOf("Opera"),navigator.userAgent);o.indexOf("Opera")>-1&&e(".select_bars").show(),o.indexOf("Firefox")>-1&&e(".select_bars").show(),o.indexOf("Chrome")>-1&&e(".select_bars").show(),o.indexOf("Safari")>-1&&e(".select_bars").show(),e.ajax({type:"get",url:"/market/product/category",contentType:"application/json",dataType:"json",async:!1,cache:!1,success:function(a){if(1==a.status)for(var t=0;t<a.data.length;t++){var i=a.data[t].categoryId,n=a.data[t].categoryName,s="<option value="+i+">"+n+"</option>";e(".sttled2_category").append(s)}}}),e.ajax({type:"get",url:"/market/isv/info",contentType:"application/json",async:!1,cache:!1,dataType:"json",success:function(t){if(1==t.status&&null!=t.data){if(null!=t.data.location&&t.data.location.indexOf("/")>0){var i=t.data.location.split("/")[0],s=t.data.location.split("/")[1];new n("P1","C1",i,s)}e(".isv_name").val(t.data.isvName),e(".settled_img2").find("img").attr("src",t.data.isvLogo),e(".sttled2_category").val(t.data.isvMarket),e(".tenantName").val(t.data.legalPerson),e(".sttled2_hangye option:selected").text(t.data.industry),e(".companySite").val(t.data.officialSite),e(".settled_email").val(t.data.officialEmail),e(".tenant_contactname").val(t.data.linkmanName),e(".settled_phone").val(t.data.linkmanMobile),e(".tenant_email").val(t.data.linkmanEmail),e(".chanpayAccount").val(t.data.chanpayAccount),e(".settleds_Number").val(t.data.licenceNumber),e(".settleds_ZzNumber").val(t.data.orgNumber),e(".up1").append("<img src="+t.data.licencePic+">"),e(".up2").append("<img src="+t.data.officialSeal+">"),e(".up3").append("<img src="+t.data.authLetter+">"),e(".up4").append("<img src="+t.data.legalPersonIDPic+">"),e(".settled2_fapiao").val(t.data.invoiceType),e(".tenant_Fullname").val(t.data.invoiceTitle),e(".settled2_sw").val(t.data.registerNum),e(".bank_username").val(t.data.registerName),e(".bank_branchname").val(t.data.registerAccount),e(".bank_name").val(t.data.registerAccountBank),e(".register_phone").val(t.data.registerPhone),e(".register_address").val(t.data.registerAddress),e(".send_phone").val(t.data.receiverMobile),e(".send_Name").val(t.data.receiverName),e(".send_address").val(t.data.receiverAddress),4==t.data.approveStatus?(e(".app_bottom_shenhew").css("visibility","visible"),e(".app_bottom_shenhew .app_approveReason").html(t.data.approveComment)):2==t.data.approveStatus&&e(".app_bottom_shenhew").css("visibility","visible").find("span").html(t.data.approveComment),""!=t.data.licencePic&&null!=t.data.licencePic&&a()}}}),e(".app_approveReason_i").mouseenter(function(){e(".app_approveReason").show()}),e(".app_approveReason").mouseleave(function(){e(".app_approveReason").hide()}),e(".settled_email,.tenant_email").bind("blur",function(){r.test(e(this).val())||e(this).addClass("errorinput")}).bind("focus",function(){e(this).removeClass("errorinput")}),e(".settled_phone").bind("blur",function(){l.test(e(this).val())||e(this).addClass("errorinput")}).bind("focus",function(){e(this).removeClass("errorinput")}),e(".isv_name").bind("blur",function(){""==e(this).val()&&e(this).addClass("errorinput")}).bind("focus",function(){e(this).removeClass("errorinput")}),e(".settled2_btnbc").click(function(){e(".app_bottom_shenhew").css("visibility","hidden"),t("/market/isv/save","保存成功")}),e(".settled2_btntj").click(function(){e(".app_bottom_shenhew").css("visibility","hidden"),t("/market/isv/commit","提交成功")}),s(".upi1",".up1"),s(".upi2",".up2"),s(".upi3",".up3"),s(".upi4",".up4"),s(".settled_btn_t2",".settled_img2")})});